<html lang="en-us">

<head>
    <meta charset="UTF-8">
    <title>Genie - DAL Generator </title>
    <meta name="description" content="Genie is a cross platform , open source .net data acces layer generator">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <link media="screen" href="stylesheets/normalize.css" type="text/css" rel="stylesheet">
    <link type="text/css" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,700">
    <link media="screen" href="stylesheets/stylesheet.css" type="text/css" rel="stylesheet">
    <link media="screen" href="stylesheets/github-light.css" type="text/css" rel="stylesheet">
    <link media="screen" href="stylesheets/css" type="text/css" rel="stylesheet">
    <style type="text/css">
        #share-buttons img {
            width: 35px;
            padding: 5px;
            border: 0;
            box-shadow: 0;
            display: inline;
        }
    </style>
</head>

<body>
    <div id="fb-root"></div>
    <script>(function(d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
        js = d.createElement(s); js.id = id;
        js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.10";
        fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));</script>
    <section class="page-header">
        <img src="imgs/genie.png">
        <h1 class="project-name">Genie</h1>
        <h2 class="project-tagline">Lightweight, High speed DAL Generator for .Net</h2>
        <a class="btn" href="https://github.com/rusith/genie">View on GitHub</a>
        <a class="btn" href="https://github.com/rusith/Genie/releases">Download for Windows | Linux | Mac OSX</a>
        <h3 class="project-tagline" id="downloadcountdisplay"></h3>

        <!-- I got these buttons from simplesharebuttons.com -->
        <div id="share-buttons">
            <!-- Email -->
            <a onclick="onShareButtonClick(this, 'Email')" href="mailto:?Subject=Simple Share Buttons&amp;Body=I%20saw%20this%20and%20thought%20of%20you!%20 https://rusith.github.io/Genie">
                <img src="https://simplesharebuttons.com/images/somacro/email.png" alt="Email" />
            </a>

            <!-- Facebook -->
            <a onclick="onShareButtonClick(this, 'Email')" href="http://www.facebook.com/sharer.php?u=https://rusith.github.io/Genie" target="_blank">
                <img src="https://simplesharebuttons.com/images/somacro/facebook.png" alt="Facebook" />
            </a>

            <!-- Google+ -->
            <a onclick="onShareButtonClick(this, 'Email')" href="https://plus.google.com/share?url=https://rusith.github.io/Genie" target="_blank">
                <img src="https://simplesharebuttons.com/images/somacro/google.png" alt="Google" />
            </a>

            <!-- LinkedIn -->
            <a onclick="onShareButtonClick(this, 'Email')" href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https://rusith.github.io/Genie" target="_blank">
                <img src="https://simplesharebuttons.com/images/somacro/linkedin.png" alt="LinkedIn" />
            </a>

            <!-- Print -->
            <a href="javascript:;" onclick="window.print()">
                <img src="https://simplesharebuttons.com/images/somacro/print.png" alt="Print" />
            </a>

            <!-- Reddit -->
            <a onclick="onShareButtonClick(this, 'Email')" href="http://reddit.com/submit?url=https://rusith.github.io/Genie&amp;title=Simple Share Buttons" target="_blank">
                <img src="https://simplesharebuttons.com/images/somacro/reddit.png" alt="Reddit" />
            </a>

            <!-- Twitter -->
            <a onclick="onShareButtonClick(this, 'Email')" href="https://twitter.com/share?url=https://rusith.github.io/Genie&amp;text=Simple%20Share%20Buttons&amp;hashtags=simplesharebuttons"
                target="_blank">
                <img src="https://simplesharebuttons.com/images/somacro/twitter.png" alt="Twitter" />
            </a>

            <!-- VK -->
            <a onclick="onShareButtonClick(this, 'Email')" href="http://vkontakte.ru/share.php?url=https://rusith.github.io/Genie" target="_blank">
                <img src="https://simplesharebuttons.com/images/somacro/vk.png" alt="VK" />
            </a>
        </div>
    </section>

    <section class="main-content">
        <p><a href="https://travis-ci.org/rusith/Genie"><img src="https://travis-ci.org/rusith/Genie.svg?branch=core" alt="Build Status" /></a>
            <a href="https://www.codacy.com/app/rusith/Genie?utm_source=github.com&amp;utm_medium=referral&amp;utm_content=rusith/Genie&amp;utm_campaign=Badge_Grade"><img src="https://api.codacy.com/project/badge/Grade/e324714bae3447daa66079f239cb287b"/></a></p>

        <h3 id="dataaccesslayergenerator">Data Access Layer Generator</h3>

        <p>Genie is a cross platform .Net library that can generate a data access layer for any .Net or .Net Core system using
            a relational database.</p>

        <p>Genie is written in C# for .Net core framework</p>

        <h2 id="gettingstarted">Getting Started</h2>

        <ul>
            <li>Download latest release or build the project</li>

            <li>run GenieCLI executable from the genieSetting.json file's location </li>
        </ul>

        <h2 id="howitworks">How It Works</h2>

        <ul>
            <li>Takes the given configuration file (JSON) and validates the file.</li>

            <li>Reads the database schema and creates internal modal from it.</li>

            <li>Process the model and generates file content using T4 templates</li>

            <li>Writes the file content to the disk</li>
        </ul>

        <h2 id="configuration">Configuration</h2>

        <p>It should be something like this </p>

        <pre><code class="JSON language-JSON">{
                "connectionString": "...",
                "projectPath": "...",
                "baseNamespace": "...",
                "ProjectFile": "...",
                "noDapper": false,
                "core": false,
                "enums": [
                    {
                        "table": "",
                        "valueColumn": "",
                        "nameColumn": "",
                        "type": ""
                    },
                ]
            }
            </code></pre>

        <h3 id="connectionstring">connectionString</h3>

        <p>A connection string that points to the target database. this connection string is only used to read database meta-data.
        </p>

        <h3 id="projectpath">projectPath</h3>

        <p>Path to the project (Data access layer of the target system). This path should point to a existing directory.</p>

        <h3 id="basenamespace">baseNamespace</h3>

        <p>The base namespace of the data access layer (ex :Example.DataAccess)</p>

        <h3 id="nodapper">noDapper</h3>

        <p>Include the dapper source code in the generated code (/Dapper) Dapper will not be included if set to true . will
            need to reference dapper externally.</p>

        <h3 id="core">core</h3>

        <p>If this is set to true , the generated code will target .net core framework. This uses .Net cores inbuilt DI. the
            DapperContext should be injected to use connection string.</p>

        <h3 id="projectfileoptional">projectFile (optional)</h3>

        <p>The relative path to the project file from project path. this is an optional property. if this is provided the generator
            will process the project file.</p>

        <h3 id="enumsoptional">enums (optional)</h3>

        <p>List of table details that can be used as enums. if a table has predefined set of rows which need to be accessed
            often,this table can be used as an enum table.</p>

        <p>example :</p>

        <p>the OrderType table (ID, Name) has 3 rows and these rows do not change. we can use this table as an enum table and
            can be defined in the configuration file as </p>

        <pre><code>{
                "table": "OrderType",
                "valueColumn": "ID",
                "nameColumn": "Name",
                "type": "int"
            }
            </code></pre>

        <ul>
            <li>type can be string / int / bool or double</li>
        </ul>

        <p>this will result a class which has static members for each row and and those members can be implicitly converted
            to the specified type.</p>

        <p>the resulting class will be something like this.</p>

        <pre><code class="CS language-CS">public sealed class OrderTypeEnum
            {
                private readonly int _value;
                private OrderTypeEnum(int value)
                {
                    _value = value;
                }
            
                public static implicit operator int(OrderTypeEnum @enum)
                {
                    return @enum._value;
                }
            
                private static OrderTypeEnum _shipped;
                private static OrderTypeEnum _preShipped;
                private static OrderTypeEnum _pending;
            
                public static OrderTypeEnum Shipped =&gt; _shipped ?? ( _shipped = new OrderTypeEnum(1));
            
                public static OrderTypeEnum PreShipped =&gt; _preShipped ?? ( _preShipped = new OrderTypeEnum(2));
            
                public static OrderTypeEnum Pending =&gt; _pending ?? ( _pending = new OrderTypeEnum(3));
            }
            </code></pre>

        <h1 id="generateddal">Generated DAL</h1>

        <p>The generated DAL uses <a href="https://github.com/StackExchange/Dapper">Dapper</a> (micro ORM) to map objects and
            to access the database.</p>

        <p>Implements unit of work pattern and repository pattern. each table and view has a model object and a repository.</p>

        <p>All repositories can be accessed through a unit of work.</p>

        <p>the DapperContext,should be singleton. UnitOfWork, DapperContext can be implemented using a DI Container in an upper
            layer.
        </p>

        <pre><code class="CS language-CS">// An example using Ninject
            using Example.DataAccess.Infrastructure;
            using Example.DataAccess.Infrastructure.Interfaces;
            using Ninject.Modules;
            
            namespace Example.Business.Base.Concrete.Modules
            {
                internal class DataAccessModule : NinjectModule
                {
                    public override void Load()
                    {
                        Bind&lt;IUnitOfWork&gt;().To&lt;UnitOfWork&gt;();
                        Bind&lt;IDapperContext&gt;().To&lt;DapperContext&gt;().InSingletonScope();
                    }
                }
            }
            </code></pre>

        <h2 id="repositories">Repositories</h2>

        <p>UnitOfWork can be used to access the repositories. Unit() function in the DapperContext can be used to create new
            Unit A repository contains methods to get, add, update, remove database entities all unit of work objects must
            be used in a using block.</p>

        <p>a unit has the Commit method that can be used to commit changes to the database</p>

        <pre><code class="CS language-CS">using(var unit = Context.Unit())
            {
                var userRepository = unit.UserRepository; // getting the repository
                var users = userRepository.Get().Where.GivenName.Contains("John").Filter().Query().ToList(); // Getting objects
                if (users.Count &lt; 1)
                    return null;
                var user = users.First();
                user.GivenName = "Doe"; // Updating the object .will update when committing changes 
                userRepository.Update(user); 
                var rusith = userRepository.Get().Where.GivenName.Contains("Rusith").Filter().Top(1).Query().FirstOrDefault(); // Getting an object
                userRepository.Remove(rusith); // deleting an object
            
                var newUser = new User {FamilyName = "Example", Username = "e@e.com", GivenName = "User"};
                userRepository.Add(newUser); // adding an object
            
                unit.Commit();
            }
            </code></pre>

        <h2 id="procedures">Procedures</h2>

        <p>All Stored procedures of the the database can be accessed through the Procedures object of any Unit Of Work object,
            all the parameters of the methods are nullable and null by default. A generic parameter should be provided in
            order to execute a procedure and the result will be mapped to the given class type.</p>

        <pre><code class="CS language-CS">// Executing a procedure
            unit.Procedures.SPC_GetOrders&lt;OrderDetailModel&gt;_List(100);
            </code></pre>

        <p>There are three functions for each procedure (List, Single and Void) List is for getting list of objects as the result
            Single is for getting single object as the result Void is for no result</p>

        <pre><code class="CS language-CS">// List
            IEnumarable&lt;&gt;unit.Procedures.SPC_GetOrders_List&lt;OrderDetailModel&gt;();
            // Single
            int deleted = unit.Procedures.SPC_DeleteOrder_Single&lt;bool&gt;(100);
            // Void
            unit.Procedures.SPC_DeleteOrder_Void(100);
            </code></pre>

        <h2 id="querying">Querying</h2>

        <p>DAL provides an easy way to filter objects. this is a Builder like pattern to filter objects. there is a QueryContext
            implemented for all repositories. user can access it through the <code>Get()</code> method of any repository.
            the <code>Get</code> method returns a QueryContext that is specific for the object type of the repository.</p>

        <h3 id="querycontext">QueryContext</h3>

        <p>A QueryContext contains some methods to filter, order, page the result</p>

        <h4 id="where">Where</h4>

        <p>There is a FilterContext that can be used to filter the query there is a property for each column and these properties
            can be used to chain the complete filter expression. each two expressions should be connected using And || Or
            , however if you do not specify a boolean operator between two expressions it will be <code>and</code> by default.</p>

        <pre><code class="CS language-CS">var repo = UnitOfWork.InvoicesViewRepository;
            var filter = repo.Get();
            
            if (!string.IsNullOrWhiteSpace(search))
            {
                filter.
                    Where.ShipTo.Contains(search).
                    Or.FactoryInvoiceNo.Contains(search)
                    .Or.No.Contains(search).Filter();
            }
            ...
            </code></pre>

        <p>there is a filter for every data type and every filter contains methods to filter the property. the <code>Filter()</code>            method returns the parent QueryContext.</p>

        <h4 id="orderby">OrderBy</h4>

        <p>There is a OrderContext that can be used to order the query there is a property for each column and these properties
            can be used to chain the complete order expression. an order expression can be Descending or Ascending.</p>

        <pre><code class="CS language-CS">var repo = UnitOfWork.InvoicesViewRepository;
                    var filter = repo.Get()
                        .OrderBy.ModifiedDate.Ascending().Order();
            ...
            </code></pre>

        <p>the <code>Order()</code> method returns the parent QueryContext.</p>

        <h3 id="page">Page</h3>

        <p>The <code>Page</code> function can be used to add paging to the query.</p>

        <h3 id="top">Top</h3>

        <p>Add a limit to the query.</p>

        <h3 id="skip">Skip</h3>

        <p>Skip can be used to skip certain rows from the query result.</p>

        <h3 id="take">Take</h3>

        <p>Skip can be used to Take only certain rows from the query result. Skip and Take can be used together to page the
            result.
        </p>

        <h3 id="queryfunction">Query Function</h3>

        <p>The <code>Query</code> function ends the QueryContext and returns the query result.</p>

        <h3 id="countfunction">Count Function</h3>

        <p>The <code>Count</code> function returns the count of the result.</p>

        <h3 id="filter">Filter</h3>

        <p>This function needs an <code>IEnumerable&lt;IPropertyFilter&gt;</code> which is a collection of property names, operations
            and values(if necessary) . this method can be used to filter the result in a customizable way How the operations
            are filtered and what are the operations : </p>

        <pre><code class="C# language-C#">  switch (type.ToLower())
                {
                    case "equals":
                    case "eq":
                        return QueryMaker.EqualsTo(propName, value, quoted);
                    case "notequals":
                    case "neq":
                    case "ne":
                        return QueryMaker.NotEquals(propName, value, quoted);
                    case "contains":
                    case "c":
                        return QueryMaker.Contains(propName, value);
                    case "notcontains":
                    case "nc":
                        return QueryMaker.NotContains(propName, value);
                    case "startswith":
                    case "sw":
                        return QueryMaker.StartsWith(propName, value);
                    case "notstartswith":
                    case "nsw":
                        return QueryMaker.NotStartsWith(propName, value);
                    case "endswith":
                    case "ew":
                        return QueryMaker.EndsWith(propName, value);
                    case "notendswith":
                    case "new":
                        return QueryMaker.NotEndsWith(propName, value);
                    case "isempty":
                    case "ie":
                        return QueryMaker.IsEmpty(propName);
                    case "isnotempty":
                    case "ino":
                        return QueryMaker.IsNotEmpty(propName);
                    case "isnull":
                    case "in":
                        return QueryMaker.IsNull(propName);
                    case "isnotnull":
                    case "inn":
                        return QueryMaker.IsNotNull(propName);
                    case "greaterthan":
                    case "gt":
                        return QueryMaker.GreaterThan(propName, value, quoted);
                    case "lessthan":
                    case "lt":
                        return QueryMaker.LessThan(propName, value, quoted);
                    case "greaterthanorequals":
                    case "gtoe":
                    case "gte":
                        return QueryMaker.GreaterThanOrEquals(propName, value, quoted);
                    case "lessthanorequals":
                    case "ltoe":
                    case "lte":
                        return QueryMaker.LessThanOrEquals(propName, value, quoted);
                    case "istrue":
                    case "it":
                        return QueryMaker.IsTrue(propName);
                    case "isfalse":
                    case "if":
                        return QueryMaker.IsFalse(propName);
                    default:
                        return "";
                }
            </code></pre>

        <h2 id="transactions">Transactions</h2>

        <p>You can start a transaction by calling <code>BeginTransaction</code> method in the UnitOfWork then you should pass
            the transaction to all methods you use in repositories. you can use the <code>Commit</code> method in the UnitOfWork
            to commit the transaction.</p>
        </div>
    </section>

    <div style="text-align: center;">
            <div class="fb-comments" data-href="https://rusith.github.io/Genie" data-width="800px" data-numposts="10"></div>
    </div>
    

    <!--Scripts-->
    <script>
        (function (i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date(); a = s.createElement(o),
                m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
        })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-106184053-1', 'auto');
        ga('send', 'pageview');
    </script>

    <script type="text/javascript">
        onShareButtonClick(obj, name)
        {
            var href = obj.getAttribute("href");
            ga('send', {
                'hitType': 'social',
                'socialNetwork': name,
                'socialTarget': href,
                'page': 'https://rusith.github.io/Genie',
                'hitCallback': function() {
                    window.open(href, '_blank');
                }
            });
        }
    </script>

</body>



</html>